# HeaRT

Official code for the paper "Evaluating Graph Neural Networks for Link Prediction: Current Pitfalls and New Benchmarking".


## Installation

The experiments were run using python 3.9. The required packages and their versions can be installed via the `requirements.txt` file. 
```
pip install -r requirements.txt
``` 

One exception is the original PEG code (`benchmarking/baseline_models/PEG`), which were run using python 3.7 and the packages in the `peg_requirements.txt` file.


## Download Data

All data can be downloaded via the following:
```
cd HeaRT  # Must be in the root directory
curl https://cse.msu.edu/~shomerha/HeaRT-Data/dataset.tar.gz | tar -xvz
``` 
This includes the negative samples generated by HeaRT and the splits for Cora, Citeseer, and Pubmed. The data for the OGB datasets will be automatically downloaded from the `ogb` package.

Please note that the resulting directory `dataset` must be placed in the root project directory.


## Reproduce Results

To reproduce the results, please refer to the settings in the **hyparameter** directory


## Generate Negative Samples using HeaRT

The code for generating the new negative samples can be found in the `heart_negatives` directory. To reproduce those used in the study, please see the scripts in the `scripts/HeaRT` directory. 

A custom set of negative samples can be produced by running the `heart_negatives/create_heart_negatives.py` script. Multiple options exist to customize the negative samples. This includes:
- The CN metric used. Can be either `CN` or `RA` (default is `RA`). Specified via the `--cn-metric` argument.
- The aggregation function used. Can be either `min` or `mean` (default is `min`). Specified via the `--agg` argument.
- The number of negatives generated per positive sample. Specified via the `--num-samples` argument (default is 500).
- The PPR parameters. This includes the tolerance used for approximating the PPR (`--eps` argument) and the teleporation probability (`--alpha` argument). `alpha` is fixed at 0.15 for all datasets. For the tolerance `eps`, we recommend following the settings found in `scripts/HeaRT`.


## Cite



